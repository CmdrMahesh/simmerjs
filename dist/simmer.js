(function(){var u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function(a,g,d,h){function f(k,b){if(!0===l.errorHandling)throw k;"function"===typeof l.errorHandling&&l.errorHandling(k,b)}function n(k,b){b=b||k.stack.length;var a=[],c=0,e;for(e=b-1;0<=e;--e)0===k.stack[e].length?e!==b-1-c?a.push("*"):c+=1:a.push(k.stack[e].join(""));return a.join(" \x3e ")}
function m(k,b,a){var c=!1,e;for(e=1;e<=b.stack.length&&!c;e+=1){c=n(b,e);if(a&&c.length>a)return!1;c=t.query(c);if(c=1===c.length&&(k.el!==h?c[0]===k.el:c[0]===k))b.verificationDepth=e}return c}function v(){var a=r.getMethods();this.next=function(b,k,c){return this.finished()?!1:a.shift()(b,k,c)};this.finished=function(){return 0===a.length}}var p=a.Simmer,l={queryEngine:null,specificityThreshold:100,depth:3,errorHandling:!1,selectorMaxLength:512},t=new d,r={methods:[],getMethods:function(){return this.methods.slice(0)},
addMethod:function(a,b){b=b&&"object"===("undefined"===typeof b?"undefined":u(b))?b:this;this.methods.push(g.bind(a,b))},validationHelpers:{tagName:function(a){return"string"===typeof a&&null!==a.match(/^[a-zA-Z0-9]+$/gi)?a:!1},attr:function(a){return"string"===typeof a&&null!==a.match(/^[0-9a-zA-Z][a-zA-Z_\-\:0-9\.]*$/gi)?a:!1},className:function(a){return"string"===typeof a&&null!==a.match(/^\.?[a-zA-Z_\-\:0-9]*$/gi)?a:!1}}};var q=a.Simmer=function(a){if(!a)return f.call(q,Error("Simmer: No element was specified for parsing."),
a),!1;var b=t.wrap(a),k=l.depth,c=[],e;for(e=0;e<k&&null!==b;e+=1)c[e]=b,b=c[e].parent();b={stack:[],specificity:0};e=new v;for(k=0;k<c.length;k+=1)b.stack[k]=[];for(;!e.finished()&&!b.verified;)try{b=e.next(c,b,l),b.specificity>=l.specificityThreshold&&!b.verified&&(b.verified=m(a,b,l.selectorMaxLength))}catch(w){f.call(q,w,a)}if(b.verified===h||b.specificity<l.specificityThreshold)b.verified=m(a,b,l.selectorMaxLength);return b.verified?b.verificationDepth?n(b,b.verificationDepth):n(b):!1};t.attachQueryEngine(l.queryEngine,
f,q);q.VERSION="0.2.0";q.noConflict=function(){a.Simmer=p;return this};q.configuration=function(a){var b,k;if(a&&a instanceof Object)for(b in a)a.hasOwnProperty(b)&&l.hasOwnProperty(b)&&(l[b]=a[b],"queryEngine"===b&&(k=!0));k&&t.attachQueryEngine(l.queryEngine,f,q);return l};r.addMethod(function(a,b,d){var c;for(c=0;c<a.length&&!b.verified;c+=1){var e=a[c];(e=this.validationHelpers.attr(e.attr("id")))&&t.isUniqueElementID(e)&&(b.stack[c].push("[id\x3d'"+e+"']"),b.specificity+=100,0===c?m(a[0],b,d.selectorMaxLength)?
b.verified=!0:(b.stack[c].pop(),b.specificity-=100):b.specificity>=d.specificityThreshold&&m(a[0],b,d.selectorMaxLength)&&(b.verified=!0))}return b});r.addMethod(function(a,b){var d;for(d=0;d<a.length;d+=1){var c=a[d];if(c=this.validationHelpers.tagName(c.getTag()))b.stack[d].splice(0,0,c),b.specificity+=10}return b});r.addMethod(function(a,b,d){var c=a[0];switch(c.getTag()){case "A":if(c=c.attr("href"))b.stack[0].push('A[href\x3d"'+c+'"]'),b.specificity+=10;break;case "IMG":if(c=c.attr("src"))b.stack[0].push('IMG[src\x3d"'+
c+'"]'),b.specificity+=10;break;default:return b}m(a[0],b,d.selectorMaxLength)?b.verified=!0:b.stack[0].pop();return b});r.addMethod(function(a,b){var d,c;for(d=0;d<a.length;d+=1){var e=a[d];if((e=e.attr("class"))&&"string"===typeof e&&(e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),c=e.match(/([^\s]+)/gi))){0<c.length&&(c[0]="."+c[0]);10<c.length&&c.splice(10,c.length-10);for(e=0;e<c.length;e+=1)this.validationHelpers.className(c[e])||c.splice(e,1);b.stack[d].push(c.join("."));b.specificity+=10*c.length}}return b});
r.addMethod(function(a,b,d){for(var c=0,e,f;c<a.length&&!b.verified;)e=a[c].prevAll(),f=e.length+1,e=e.concat(a[c].nextAll()),0!==e.length&&(e=this.analyzeElementSiblings(a[c],e),e||(b.stack[c].push(":nth-child("+f+")"),b.verified=m(a[0],b,d.selectorMaxLength))),c+=1;return b},{analyzeElementSiblings:function(a,b){var d=a.getTag(),c=a.getClasses(),e=!0,f=c[0]instanceof Array&&0<c[0].length,h;for(a=0;a<b.length&&(f||e);a+=1)f=b[a],(h=f.getTag())&&h===d&&(e=!1),f=0<g.difference(c,f.getClasses()).length;
return f||e}})})(window,{breaker:{},contains:function(a,g){var d=!1;return null===a?d:a instanceof Array?-1!==a.indexOf(g):d=this.any(a,function(a){return a===g})},any:function(a,g,d){var h=!1;if(null===a)return h;if(a instanceof Array)return a.some(g,d);this.each(a,function(a,n,m){if(h=h||g.call(d,a,n,m))return this.breaker});return!!h},each:function(a,g,d){var h;if(null!==a)if(a instanceof Array)a.forEach(g,d);else if(a.length===+a.length){var f=0;for(h=a.length;f<h&&(void 0===a[f]||g.call(d,a[f],
f,a)!==this.breaker);f+=1);}else for(f in a)if(a.hasOwnProperty(f)&&g.call(d,a[f],f,a)===this.breaker)break},filter:function(a,g,d){var h=[];if(null===a)return h;if(a instanceof Array)return a.filter(g,d);this.each(a,function(a,n,m){g.call(d,a,n,m)&&(h[h.length]=a)});return h},difference:function(a,g){return this.filter(a,function(a){return!this.contains(g,a)},this)},isFunction:function(a){return!!(a&&a.constructor&&a.call&&a.apply)},bind:function(a,g){if(!this.isFunction(a))throw new TypeError("Bind must be called on a function");
if(Function.prototype&&Function.prototype.bind)return a.bind.apply(a,Array.prototype.slice.call(arguments,1));var d=Array.prototype.slice.call(arguments,2);return function(){return a.apply(g,d.concat(Array.prototype.slice.call(arguments)))}}},function(a,g){var d=function(){this.attachQueryEngine=function(d,f,g){var h=a.document;d&&"function"===typeof d?this.queryEngine=d:a.Sizzle?this.queryEngine=function(d){try{return a.Sizzle(d)}catch(p){f.call(g,p,null)}}:a.jQuery?this.queryEngine=function(d){try{return a.jQuery(d).toArray()}catch(p){f.call(g,
p,null)}}:h&&h.querySelectorAll&&"function"===typeof h.querySelectorAll&&(this.queryEngine=function(a){try{return h.querySelectorAll(a)}catch(p){f.call(g,p,null)}})};this.query=function(a){return"string"!==typeof a||"function"!==typeof this.queryEngine?[]:this.queryEngine(a)}};d.prototype=g;return d}(window,{isUniqueElementID:function(a){return 1===this.query('[id\x3d"'+a+'"]').length},wrap:function(a){var g=this;return{el:a,attr:function(a){return this.el.getAttribute(a)},getTag:function(){return this.el.nodeName},
getClass:function(){var a=this.attr("class");return a?a:""},getClasses:function(){var a=this.attr("class");return a&&"string"===typeof a&&(a=a.replace(/^\s\s*/,"").replace(/\s\s*$/,""),""!==a)?a.split(" "):[]},prevAll:function(){return this.dir("previousSibling")},nextAll:function(){return this.dir("nextSibling")},parent:function(){var a=this.el.parentNode;return a&&11!==a.nodeType?g.wrap(a):null},dir:function(a){for(var d=[],f=this.el[a];f&&9!==f.nodeType;)1===f.nodeType&&d.push(g.wrap(f)),f=f[a];
return d}}}}))})();
